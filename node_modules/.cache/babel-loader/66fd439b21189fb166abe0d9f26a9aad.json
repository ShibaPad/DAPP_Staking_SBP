{"ast":null,"code":"import { configs } from 'eslint-plugin-prettier';\nimport { observable } from 'mobx';\nimport Repository from './repository';\nconst {\n  ethereum\n} = window;\nconst Store = observable({\n  account: null,\n  stakingContract: null,\n  //SHIBA STAKING SMART CONTRACT\n  SBPContract: null,\n  // $SBP SMART CONTRACT\n  web3: null,\n  stakingInfo: {\n    TVL: '',\n    // total value locked\n    accountStakingTotal: 0,\n    // Your SBPS in Staking\n    totalExpectedReward: 0,\n    // Total Expected Reward\n    tier: '',\n    // Account Tier\n    SBPBalance: 0 // Account $SBP Balance\n\n  },\n  stakingPool: [],\n  //Staking Pools\n  stakeIDs: [],\n  // StakeIDs of Account\n  stakedPools: [],\n  //Staked Pool of Account\n  paneltyFee: 0,\n\n  // Panelty Fee\n  async fetchContract() {\n    try {\n      await Repository.fetchContract().then(res => {\n        if (res) {\n          const {\n            smartContract_SBP,\n            smartContract_staking,\n            web3\n          } = res;\n          this.stakingContract = smartContract_staking;\n          this.SBPContract = smartContract_SBP;\n          this.web3 = web3;\n        }\n      });\n      return true;\n    } catch (err) {// console.log('err: ', err);\n    }\n  },\n\n  async connectWallet() {\n    try {\n      await Repository.walletConnect().then(res => {\n        if (res) {\n          this.account = res;\n          this.fetchAccountInfo();\n        }\n      });\n      return {\n        result: true,\n        msg: 'Succeed Connect Wallet'\n      };\n    } catch (err) {\n      return {\n        result: false,\n        msg: err\n      };\n    }\n  },\n\n  addAccountListner(fetch) {\n    ethereum.on('accountsChanged', _ref => {\n      let [accounts] = _ref;\n      this.account = accounts;\n      this.stakeIDs = [];\n      this.stakedPools = [];\n      fetch();\n    });\n    ethereum.on('chainChanged', () => {\n      window.location.reload();\n    });\n  },\n\n  fetchAccountInfo() {\n    this.getAccountStakingTotal();\n    this.getTotalExpectedReward();\n    this.getAccountTier();\n    this.getSBPBalance();\n    this.getStakeIds();\n    this.getTVL();\n  },\n\n  async getTVL() {\n    try {\n      await Repository.getTVL(this.stakingContract.methods).then(res => {\n        if (res) this.stakingInfo.TVL = res;\n      });\n    } catch (err) {\n      return err;\n    }\n  },\n\n  async getAccountStakingTotal() {\n    try {\n      await Repository.getAccountStakingTotal({\n        contract: this.stakingContract.methods,\n        account: this.account\n      }).then(res => {\n        if (res) this.stakingInfo.accountStakingTotal = res;\n      });\n    } catch (err) {\n      return err;\n    }\n  },\n\n  async getTotalExpectedReward() {\n    try {\n      await Repository.getTotalExpectedReward({\n        contract: this.stakingContract.methods,\n        account: this.account\n      }).then(res => {\n        if (res) this.stakingInfo.totalExpectedReward = res;\n      });\n    } catch (err) {\n      return err;\n    }\n  },\n\n  async getAccountTier() {\n    try {\n      await Repository.getAccountTier({\n        contract: this.stakingContract.methods,\n        account: this.account\n      }).then(res => {\n        if (res) this.stakingInfo.tier = res;\n      });\n    } catch (err) {\n      return err;\n    }\n  },\n\n  async getSBPBalance() {\n    try {\n      await Repository.getSBPBalance({\n        contract: this.SBPContract.methods,\n        account: this.account\n      }).then(res => {\n        if (res) this.stakingInfo.SBPBalance = res;\n      });\n      return true;\n    } catch (err) {\n      return err;\n    }\n  },\n\n  async getPenaltyFee() {\n    try {\n      await Repository.getPenaltyFee({\n        contract: this.stakingContract.methods\n      }).then(res => {\n        if (res) this.paneltyFee = res;\n      });\n    } catch (err) {\n      return err;\n    }\n  },\n\n  async getStakingPool() {\n    //storageID (풀 종류) 조회\n    try {\n      this.stakingPool = [];\n      await Repository.getStorageNumbers({\n        contract: this.stakingContract.methods\n      }).then(async res => {\n        if (res && res > 0) {\n          let poolInfo = [];\n\n          for (let i = 0; i < res; i++) {\n            let pool = await Repository.getPoolInfo({\n              contract: this.stakingContract.methods,\n              storageID: i + 1\n            });\n            poolInfo.push({\n              storageId: i + 1,\n              ...pool\n            });\n          }\n\n          this.stakingPool = poolInfo;\n        } // console.log('stakingPool: ', this.stakingPool);\n\n      });\n    } catch (err) {\n      return err;\n    }\n  },\n\n  async getStakeIds() {\n    //유저가 stakedid 목록 조회\n    try {\n      this.stakedPools = [];\n      await Repository.getStakeIds({\n        contract: this.stakingContract.methods,\n        account: this.account\n      }).then(async res => {\n        if (res && res.length > 0) {\n          this.stakeIDs = res;\n\n          for (let i = 0; i < res.length; i++) {\n            await this.getStakedPool(res[i]).then(res => {\n              // if (res) this.stakedPools.push({ ...res, stakingId: res[i] });\n              if (res) this.stakedPools.push(res);\n            });\n          }\n\n          setTimeout(() => {}, 3000);\n        }\n      });\n    } catch (err) {}\n  },\n\n  async getStakedPool(stakeId) {\n    //staking 한 stakeid로 pool 검색\n    try {\n      const res = await Repository.getStakedPool({\n        contract: this.stakingContract.methods,\n        account: this.account,\n        stakeIds: stakeId\n      });\n      return { ...res,\n        stakingId: stakeId\n      };\n    } catch (err) {\n      console.log(err);\n    }\n  },\n\n  async approveMax(_ref2) {\n    let {\n      spender\n    } = _ref2;\n\n    try {\n      await Repository.stakeSBP({\n        contract: this.SBPContract.methods,\n        spender: spender,\n        account: this.account\n      });\n      return {\n        result: true,\n        msg: 'Succeed Staking SBP'\n      };\n    } catch (err) {\n      return {\n        result: false,\n        msg: 'Failed Staking SBP'\n      };\n    }\n  },\n\n  async stakeSBP(_ref3) {\n    let {\n      amount,\n      storageId\n    } = _ref3;\n\n    try {\n      await Repository.stakeSBP({\n        contract: this.stakingContract.methods,\n        amount: amount,\n        storageId: storageId,\n        account: this.account\n      });\n      return {\n        result: true,\n        msg: 'Succeed Staking SBP'\n      };\n    } catch (err) {\n      return {\n        result: false,\n        msg: 'Failed Staking SBP'\n      };\n    }\n  },\n\n  async unStakeSBP(stakedId) {\n    try {\n      await Repository.unStake({\n        contract: this.stakingContract.methods,\n        stakedId: stakedId,\n        account: this.account\n      });\n      return {\n        result: true,\n        msg: 'Succeed Claim Reward'\n      };\n    } catch (err) {\n      return {\n        result: false,\n        msg: 'Failed Claim Reward'\n      };\n    }\n  },\n\n  async earlyClaimSBP(stakedId) {\n    try {\n      await Repository.earlyClaimSBP({\n        contract: this.stakingContract.methods,\n        stakedId: stakedId,\n        account: this.account\n      });\n      return {\n        result: true,\n        msg: 'Succeed Early Claim Reward'\n      };\n    } catch (err) {\n      return {\n        result: false,\n        msg: 'Failed Claim Early Reward'\n      };\n    }\n  },\n\n  async getStakeStatus(stakedId) {\n    try {\n      return await Repository.getStakeStatus({\n        contract: this.stakingContract.methods,\n        stakedId: stakedId,\n        account: this.account\n      });\n    } catch (err) {//\n    }\n  },\n\n  async getExpectedPoolReward(stakedId) {\n    try {\n      return await Repository.getExpectedPoolReward({\n        contract: this.stakingContract.methods,\n        stakedId: stakedId,\n        account: this.account\n      });\n    } catch (err) {//\n    }\n  }\n\n});\nexport default Store;","map":{"version":3,"sources":["C:/Users/user/Desktop/shibapad_staking-main (2)/shibapad_staking-main/src/store/store.js"],"names":["configs","observable","Repository","ethereum","window","Store","account","stakingContract","SBPContract","web3","stakingInfo","TVL","accountStakingTotal","totalExpectedReward","tier","SBPBalance","stakingPool","stakeIDs","stakedPools","paneltyFee","fetchContract","then","res","smartContract_SBP","smartContract_staking","err","connectWallet","walletConnect","fetchAccountInfo","result","msg","addAccountListner","fetch","on","accounts","location","reload","getAccountStakingTotal","getTotalExpectedReward","getAccountTier","getSBPBalance","getStakeIds","getTVL","methods","contract","getPenaltyFee","getStakingPool","getStorageNumbers","poolInfo","i","pool","getPoolInfo","storageID","push","storageId","length","getStakedPool","setTimeout","stakeId","stakeIds","stakingId","console","log","approveMax","spender","stakeSBP","amount","unStakeSBP","stakedId","unStake","earlyClaimSBP","getStakeStatus","getExpectedPoolReward"],"mappings":"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","sourcesContent":["import { configs } from 'eslint-plugin-prettier';\nimport { observable } from 'mobx';\nimport Repository from './repository';\nconst { ethereum } = window;\nconst Store = observable({\n  account: null,\n  stakingContract: null, //SHIBA STAKING SMART CONTRACT\n  SBPContract: null, // $SBP SMART CONTRACT\n  web3: null,\n  stakingInfo: {\n    TVL: '', // total value locked\n    accountStakingTotal: 0, // Your SBPS in Staking\n    totalExpectedReward: 0, // Total Expected Reward\n    tier: '', // Account Tier\n    SBPBalance: 0, // Account $SBP Balance\n  },\n  stakingPool: [], //Staking Pools\n  stakeIDs: [], // StakeIDs of Account\n  stakedPools: [], //Staked Pool of Account\n  paneltyFee: 0, // Panelty Fee\n\n  async fetchContract() {\n    try {\n      await Repository.fetchContract().then(res => {\n        if (res) {\n          const { smartContract_SBP, smartContract_staking, web3 } = res;\n          this.stakingContract = smartContract_staking;\n          this.SBPContract = smartContract_SBP;\n          this.web3 = web3;\n        }\n      });\n      return true;\n    } catch (err) {\n      // console.log('err: ', err);\n    }\n  },\n  async connectWallet() {\n    try {\n      await Repository.walletConnect().then(res => {\n        if (res) {\n          this.account = res;\n          this.fetchAccountInfo();\n        }\n      });\n      return { result: true, msg: 'Succeed Connect Wallet' };\n    } catch (err) {\n      return { result: false, msg: err };\n    }\n  },\n  addAccountListner(fetch) {\n    ethereum.on('accountsChanged', ([accounts]) => {\n      this.account = accounts;\n      this.stakeIDs = [];\n      this.stakedPools = [];\n      fetch();\n    });\n    ethereum.on('chainChanged', () => {\n      window.location.reload();\n    });\n  },\n  fetchAccountInfo() {\n    this.getAccountStakingTotal();\n    this.getTotalExpectedReward();\n    this.getAccountTier();\n    this.getSBPBalance();\n    this.getStakeIds();\n    this.getTVL();\n  },\n  async getTVL() {\n    try {\n      await Repository.getTVL(this.stakingContract.methods).then(res => {\n        if (res) this.stakingInfo.TVL = res;\n      });\n    } catch (err) {\n      return err;\n    }\n  },\n\n  async getAccountStakingTotal() {\n    try {\n      await Repository.getAccountStakingTotal({\n        contract: this.stakingContract.methods,\n        account: this.account,\n      }).then(res => {\n        if (res) this.stakingInfo.accountStakingTotal = res;\n      });\n    } catch (err) {\n      return err;\n    }\n  },\n\n  async getTotalExpectedReward() {\n    try {\n      await Repository.getTotalExpectedReward({\n        contract: this.stakingContract.methods,\n        account: this.account,\n      }).then(res => {\n        if (res) this.stakingInfo.totalExpectedReward = res;\n      });\n    } catch (err) {\n      return err;\n    }\n  },\n  async getAccountTier() {\n    try {\n      await Repository.getAccountTier({\n        contract: this.stakingContract.methods,\n        account: this.account,\n      }).then(res => {\n        if (res) this.stakingInfo.tier = res;\n      });\n    } catch (err) {\n      return err;\n    }\n  },\n  async getSBPBalance() {\n    try {\n      await Repository.getSBPBalance({\n        contract: this.SBPContract.methods,\n        account: this.account,\n      }).then(res => {\n        if (res) this.stakingInfo.SBPBalance = res;\n      });\n      return true;\n    } catch (err) {\n      return err;\n    }\n  },\n  async getPenaltyFee() {\n    try {\n      await Repository.getPenaltyFee({\n        contract: this.stakingContract.methods,\n      }).then(res => {\n        if (res) this.paneltyFee = res;\n      });\n    } catch (err) {\n      return err;\n    }\n  },\n  async getStakingPool() {\n    //storageID (풀 종류) 조회\n    try {\n      this.stakingPool = [];\n      await Repository.getStorageNumbers({\n        contract: this.stakingContract.methods,\n      }).then(async res => {\n        if (res && res > 0) {\n          let poolInfo = [];\n          for (let i = 0; i < res; i++) {\n            let pool = await Repository.getPoolInfo({\n              contract: this.stakingContract.methods,\n              storageID: i + 1,\n            });\n            poolInfo.push({ storageId: i + 1, ...pool });\n          }\n          this.stakingPool = poolInfo;\n        }\n        // console.log('stakingPool: ', this.stakingPool);\n      });\n    } catch (err) {\n      return err;\n    }\n  },\n  async getStakeIds() {\n    //유저가 stakedid 목록 조회\n    try {\n      this.stakedPools = [];\n      await Repository.getStakeIds({\n        contract: this.stakingContract.methods,\n        account: this.account,\n      }).then(async res => {\n        if (res && res.length > 0) {\n          this.stakeIDs = res;\n          for (let i = 0; i < res.length; i++) {\n            await this.getStakedPool(res[i]).then(res => {\n              // if (res) this.stakedPools.push({ ...res, stakingId: res[i] });\n              if (res) this.stakedPools.push(res);\n            });\n          }\n          setTimeout(() => {}, 3000);\n        }\n      });\n    } catch (err) {}\n  },\n  async getStakedPool(stakeId) {\n    //staking 한 stakeid로 pool 검색\n    try {\n      const res = await Repository.getStakedPool({\n        contract: this.stakingContract.methods,\n        account: this.account,\n        stakeIds: stakeId,\n      });\n      return { ...res, stakingId: stakeId };\n    } catch (err) {\n      console.log(err);\n    }\n  },\n  async approveMax({ spender }) {\n    try {\n      await Repository.stakeSBP({\n        contract: this.SBPContract.methods,\n        spender: spender,\n        account: this.account,\n      });\n      return { result: true, msg: 'Succeed Staking SBP' };\n    } catch (err) {\n      return { result: false, msg: 'Failed Staking SBP' };\n    }\n  },\n  async stakeSBP({ amount, storageId }) {\n    try {\n      await Repository.stakeSBP({\n        contract: this.stakingContract.methods,\n        amount: amount,\n        storageId: storageId,\n        account: this.account,\n      });\n      return { result: true, msg: 'Succeed Staking SBP' };\n    } catch (err) {\n      return { result: false, msg: 'Failed Staking SBP' };\n    }\n  },\n  async unStakeSBP(stakedId) {\n    try {\n      await Repository.unStake({\n        contract: this.stakingContract.methods,\n        stakedId: stakedId,\n\n        account: this.account,\n      });\n      return { result: true, msg: 'Succeed Claim Reward' };\n    } catch (err) {\n      return { result: false, msg: 'Failed Claim Reward' };\n    }\n  },\n  async earlyClaimSBP(stakedId) {\n    try {\n      await Repository.earlyClaimSBP({\n        contract: this.stakingContract.methods,\n        stakedId: stakedId,\n        account: this.account,\n      });\n      return { result: true, msg: 'Succeed Early Claim Reward' };\n    } catch (err) {\n      return { result: false, msg: 'Failed Claim Early Reward' };\n    }\n  },\n  async getStakeStatus(stakedId) {\n    try {\n      return await Repository.getStakeStatus({\n        contract: this.stakingContract.methods,\n        stakedId: stakedId,\n        account: this.account,\n      });\n    } catch (err) {\n      //\n    }\n  },\n  async getExpectedPoolReward(stakedId) {\n    try {\n      return await Repository.getExpectedPoolReward({\n        contract: this.stakingContract.methods,\n        stakedId: stakedId,\n        account: this.account,\n      });\n    } catch (err) {\n      //\n    }\n  },\n});\n\nexport default Store;\n"]},"metadata":{},"sourceType":"module"}