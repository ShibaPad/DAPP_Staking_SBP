{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\Desktop\\\\SBPGIT\\\\DAPP_Staking_SBP\\\\src\\\\component\\\\StakingBox.js\";\nimport React, { useEffect, useState } from 'react';\nimport styled from 'styled-components';\nimport shiba from '../assets/shiba.png';\nimport Store from '../store/store';\nimport Input from './Input';\nimport { Text, Row } from './style';\nimport { useObserver } from 'mobx-react';\nimport { useAlert } from 'react-alert';\n\nconst stakeable = (allownce, stakeAmount) => {\n  return Number(allownce) >= Number(stakeAmount);\n};\n\nconst StakingBox = () => {\n  const alert = useAlert();\n  const [stakingInfo, setStakingInfo] = useState({});\n  const [stakingAmount, setStakingAmount] = useState('');\n  const [disable, setDisable] = useState(true);\n  useEffect(() => {\n    if (stakingInfo.storageId && stakingAmount && Store.account && Number(stakingInfo.minAmount) <= Number(stakingAmount * 10 ** 18) && Number(stakingAmount * 10 ** 18) <= Number(Store.stakingInfo.SBPBalance) || !stakeable(Store.stakingInfo.allowance, stakingAmount * 10 ** 18)) setDisable(false);else setDisable(true);\n  }, [Store.stakingInfo.SBPBalance, Store.account, Store.stakingInfo.allowance, stakingAmount, stakingInfo]);\n\n  const handleSelect = info => setStakingInfo(info);\n\n  const handleAmount = e => {\n    const {\n      value\n    } = e.target;\n    if (value && value > 0) setStakingAmount(value);\n    if (!value) setStakingAmount('');\n  };\n\n  const handleStake = async () => {\n    if (stakeable(Store.stakingInfo.allowance, stakingAmount * 10 ** 18)) {\n      Store.getSBPBalance().then(async res => {\n        if (res && Store.account && stakingAmount > 0 && Number(stakingAmount * 10 ** 18) <= Number(Store.stakingInfo.SBPBalance)) {\n          await Store.stakeSBP({\n            amount: stakingAmount * 10 ** 18,\n            storageId: stakingInfo.storageId\n          }).then(res => {\n            if (res) console.log('box', res);\n\n            if (res.result) {\n              // success\n              alert.show(res.msg, {\n                type: 'success'\n              });\n              Store.fetchAccountInfo(); // TVL, staking balance, total Expected Reward, tier, sbp balance, stakingList\n            } else {\n              // fail\n              alert.show(res.msg, {\n                type: 'error'\n              });\n            }\n          });\n        } else {//balance err\n        }\n      });\n    } else {\n      Store.ApproveMaxBalance().then(res => {\n        if (res.result) {\n          alert.show(res.msg, {\n            typed: 'success'\n          });\n        } else {\n          alert.show(res.msg, {\n            type: 'error'\n          });\n        }\n      });\n    }\n  };\n\n  return useObserver(() => {\n    return /*#__PURE__*/React.createElement(StakingWrapper, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(SelectWrapper, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Text, {\n      color: \"#ffffff\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 13\n      }\n    }, \"Total Value Locked : \"), /*#__PURE__*/React.createElement(Text, {\n      color: \"#f6c179\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 13\n      }\n    }, Store.stakingInfo.TVL / 10 ** 18, \" SBP\")), /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Text, {\n      color: \"#ffffff\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 13\n      }\n    }, \"Locked Period : \")), /*#__PURE__*/React.createElement(SelectBoxWrapper, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 11\n      }\n    }, Store.stakingPool && Store.stakingPool.length > 0 && Store.stakingPool.map((elem, index) => {\n      return /*#__PURE__*/React.createElement(SelectBox, {\n        checked: stakingInfo.storageId === elem.storageId,\n        onClick: () => handleSelect(elem),\n        onClickCapture: () => setStakingAmount(''),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 19\n        }\n      }, elem.name);\n    })), /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Text, {\n      color: \"#ffffff\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 13\n      }\n    }, \"Reward rate for \"), /*#__PURE__*/React.createElement(Text, {\n      color: \"#66ac5b\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 13\n      }\n    }, stakingInfo.name ? `${stakingInfo.name} : ` : null), /*#__PURE__*/React.createElement(Text, {\n      color: \"#f6c179\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 13\n      }\n    }, stakingInfo.rewardPercentage ? `${stakingInfo.rewardPercentage}%` : null)), /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Text, {\n      color: \"#ffffff\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 13\n      }\n    }, \"Minimum Amount to Stake: \"), /*#__PURE__*/React.createElement(Text, {\n      color: \"#f6c179\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 13\n      }\n    }, stakingInfo.minAmount ? `${stakingInfo.minAmount / 10 ** 18} SBP` : null))), /*#__PURE__*/React.createElement(StakingInfoWrapper, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(FlexDiv, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(StakingInfo, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Text, {\n      color: \"#d5ccc8\",\n      width: \"10rem\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 17\n      }\n    }, \"Your SBPs in Staking :\", ' '), /*#__PURE__*/React.createElement(Text, {\n      color: \"#f6c179\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 17\n      }\n    }, Store.stakingInfo.accountStakingTotal / 10 ** 18, \" SBP\", ' ')), /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Text, {\n      color: \"#d5ccc8\",\n      width: \"10rem\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 17\n      }\n    }, \"TotalEstimatedRewards :\", ' '), /*#__PURE__*/React.createElement(Text, {\n      color: \"#f6c179\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 17\n      }\n    }, Store.stakingInfo.totalExpectedReward / 10 ** 18, \" SBP\", ' ')), /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Text, {\n      color: \"#d5ccc8\",\n      width: \"10rem\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 17\n      }\n    }, \"Account Tier :\"), /*#__PURE__*/React.createElement(Text, {\n      color: \"#f6c179\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 17\n      }\n    }, \" \", Store.stakingInfo.tier, \" \")), /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Text, {\n      color: \"#d5ccc8\",\n      width: \"10rem\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 17\n      }\n    }, \"Account SBP Balance :\", ' '), /*#__PURE__*/React.createElement(Text, {\n      color: \"#f6c179\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 17\n      }\n    }, Store.stakingInfo.SBPBalance / 10 ** 18, \" SBP \"))), /*#__PURE__*/React.createElement(Logo, {\n      src: shiba,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(Input, {\n      style: {\n        marginTop: '1rem'\n      },\n      onChange: handleAmount,\n      value: stakingAmount,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(FlexDiv, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(StakeButton, {\n      onClick: handleStake,\n      disabled: disable,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 13\n      }\n    }, stakeable(Store.stakingInfo.allowance, stakingAmount) ? 'StakeSBP' : 'ApproveSBP'))));\n  });\n};\n\nexport default StakingBox;\nconst StakingWrapper = styled.div`\n  border-radius: 1rem;\n  border: solid 0.13rem #f6c179;\n  margin: 0 1rem 0 1rem;\n  background-color: #594139;\n`;\nconst SelectWrapper = styled.div`\n  background-color: #74564a;\n  border-radius: 0.85rem 0.85rem 0 0;\n  padding: 1rem;\n`;\nconst SelectBoxWrapper = styled.div`\n  padding: 0.5rem;\n  display: flex;\n  flex: 1 1 0;\n`;\nconst SelectBox = styled.button`\n  border-radius: 0.25rem;\n  border: ${props => props.checked ? 'solid 2px #fff' : 'none'};\n  /* margin: 0.1rem 0.5rem 0.1rem 0.5rem; */\n  margin: auto 0.1rem auto 0.1rem;\n  color: ${props => props.checked ? '#fff' : '#74564a'};\n  background-color: ${props => props.checked ? '#66ac5b' : '#d5ccc8'};\n  &:hover {\n    background-color: #66ac5b;\n    color: '#74564a';\n  }\n  font-family: Teko;\n  font-size: 1.3rem;\n  transition: background-color 0.25s ease-out 100ms;\n`;\nconst StakingInfoWrapper = styled.div`\n  padding: 1rem;\n  border-radius: 0 0 0.85rem 0.85rem;\n  background-color: #594139;\n  /* display: flex; */\n`;\nconst StakingInfo = styled.div`\n  flex: auto;\n  min-width: 11rem;\n`;\nconst Logo = styled.img`\n  width: 8rem;\n  @media (max-width: 500px) {\n    width: 6rem;\n  }\n  @media (max-width: 360px) {\n    width: 4rem;\n  }\n  object-fit: contain;\n\n  margin: 0 0 0 1rem;\n`;\nconst FlexDiv = styled.div`\n  display: flex;\n`;\nconst StakeButton = styled.button`\n  width: 7rem;\n  height: 2rem;\n  border-radius: 1rem;\n  border: solid 2px #d5ccc8;\n  background-color: #66ac5b;\n  font-family: Teko;\n  font-size: 1.3rem;\n  font-weight: 500;\n  font-stretch: normal;\n  font-style: normal;\n  /* line-height: 1; */\n  letter-spacing: normal;\n  text-align: center;\n  color: #fff;\n  margin: 1rem auto 0 auto;\n  ${props => {\n  if (props.disabled) {\n    return 'border: solid 2px #757575; background-color: #74564a; color: #757575';\n  }\n}}\n`;","map":{"version":3,"sources":["C:/Users/user/Desktop/SBPGIT/DAPP_Staking_SBP/src/component/StakingBox.js"],"names":["React","useEffect","useState","styled","shiba","Store","Input","Text","Row","useObserver","useAlert","stakeable","allownce","stakeAmount","Number","StakingBox","alert","stakingInfo","setStakingInfo","stakingAmount","setStakingAmount","disable","setDisable","storageId","account","minAmount","SBPBalance","allowance","handleSelect","info","handleAmount","e","value","target","handleStake","getSBPBalance","then","res","stakeSBP","amount","console","log","result","show","msg","type","fetchAccountInfo","ApproveMaxBalance","typed","TVL","stakingPool","length","map","elem","index","name","rewardPercentage","accountStakingTotal","totalExpectedReward","tier","marginTop","StakingWrapper","div","SelectWrapper","SelectBoxWrapper","SelectBox","button","props","checked","StakingInfoWrapper","StakingInfo","Logo","img","FlexDiv","StakeButton","disabled"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport styled from 'styled-components';\nimport shiba from '../assets/shiba.png';\nimport Store from '../store/store';\nimport Input from './Input';\nimport { Text, Row } from './style';\nimport { useObserver } from 'mobx-react';\nimport { useAlert } from 'react-alert';\n\nconst stakeable = (allownce, stakeAmount) => {\n  return Number(allownce) >= Number(stakeAmount);\n};\nconst StakingBox = () => {\n  const alert = useAlert();\n  const [stakingInfo, setStakingInfo] = useState({});\n  const [stakingAmount, setStakingAmount] = useState('');\n  const [disable, setDisable] = useState(true);\n\n  useEffect(() => {\n    if (\n      (stakingInfo.storageId &&\n        stakingAmount &&\n        Store.account &&\n        Number(stakingInfo.minAmount) <= Number(stakingAmount*10**18) &&\n        Number(stakingAmount*10**18) <= Number(Store.stakingInfo.SBPBalance)) ||\n      !stakeable(Store.stakingInfo.allowance, stakingAmount*10**18)\n    )\n      setDisable(false);\n    else setDisable(true);\n  }, [\n    Store.stakingInfo.SBPBalance,\n    Store.account,\n    Store.stakingInfo.allowance,\n    stakingAmount,\n    stakingInfo,\n  ]);\n\n  const handleSelect = info => setStakingInfo(info);\n\n  const handleAmount = e => {\n    const { value } = e.target;\n    if (value && value > 0) setStakingAmount(value);\n    if (!value) setStakingAmount('');\n  };\n\n  const handleStake = async () => {\n    if (stakeable(Store.stakingInfo.allowance, stakingAmount*10**18)) {\n      Store.getSBPBalance().then(async res => {\n        if (\n          res &&\n          Store.account &&\n          stakingAmount > 0 &&\n          Number(stakingAmount*10**18) <= Number(Store.stakingInfo.SBPBalance)\n        ) {\n          await Store.stakeSBP({\n            amount: stakingAmount*10**18,\n            storageId: stakingInfo.storageId,\n          }).then(res => {\n            if (res) console.log('box', res);\n            if (res.result) {\n              // success\n              alert.show(res.msg, { type: 'success' });\n              Store.fetchAccountInfo();\n              // TVL, staking balance, total Expected Reward, tier, sbp balance, stakingList\n            } else {\n              // fail\n              alert.show(res.msg, { type: 'error' });\n            }\n          });\n        } else {\n          //balance err\n        }\n      });\n    } else {\n      Store.ApproveMaxBalance().then(res => {\n        if (res.result) {\n          alert.show(res.msg, { typed: 'success' });\n        } else {\n          alert.show(res.msg, { type: 'error' });\n        }\n      });\n    }\n  };\n  return useObserver(() => {\n    return (\n      <StakingWrapper>\n        <SelectWrapper>\n          <Row>\n            <Text color=\"#ffffff\">Total Value Locked : </Text>\n            <Text color=\"#f6c179\">{Store.stakingInfo.TVL/10**18} SBP</Text>\n          </Row>\n          <Row>\n            <Text color=\"#ffffff\">Locked Period : </Text>\n          </Row>\n          <SelectBoxWrapper>\n            {Store.stakingPool &&\n              Store.stakingPool.length > 0 &&\n              Store.stakingPool.map((elem, index) => {\n                return (\n                  <SelectBox\n                    checked={stakingInfo.storageId === elem.storageId}\n                    onClick={() => handleSelect(elem)}\n                    onClickCapture={() => setStakingAmount('')}\n                  >\n                    {elem.name}\n                  </SelectBox>\n                );\n              })}\n          </SelectBoxWrapper>\n          <Row>\n            <Text color=\"#ffffff\">Reward rate for </Text>\n            <Text color=\"#66ac5b\">\n              {stakingInfo.name ? `${stakingInfo.name} : ` : null}\n            </Text>\n            <Text color=\"#f6c179\">\n              {stakingInfo.rewardPercentage\n                ? `${stakingInfo.rewardPercentage}%`\n                : null}\n            </Text>\n          </Row>\n          <Row>\n            <Text color=\"#ffffff\">Minimum Amount to Stake: </Text>\n            <Text color=\"#f6c179\">\n              {stakingInfo.minAmount ? `${stakingInfo.minAmount/10**18} SBP` : null}\n            </Text>\n          </Row>\n        </SelectWrapper>\n        <StakingInfoWrapper>\n          <FlexDiv>\n            <StakingInfo>\n              <Row>\n                <Text color=\"#d5ccc8\" width=\"10rem\">\n                  Your SBPs in Staking :{' '}\n                </Text>\n                <Text color=\"#f6c179\">\n                  {Store.stakingInfo.accountStakingTotal/10**18} SBP{' '}\n                </Text>\n              </Row>\n              <Row>\n                <Text color=\"#d5ccc8\" width=\"10rem\">\n                  TotalEstimatedRewards :{' '}\n                </Text>\n                <Text color=\"#f6c179\">\n                  {Store.stakingInfo.totalExpectedReward/10**18} SBP{' '}\n                </Text>\n              </Row>\n              <Row>\n                <Text color=\"#d5ccc8\" width=\"10rem\">\n                  Account Tier :\n                </Text>\n                <Text color=\"#f6c179\"> {Store.stakingInfo.tier} </Text>\n              </Row>\n              <Row>\n                <Text color=\"#d5ccc8\" width=\"10rem\">\n                  Account SBP Balance :{' '}\n                </Text>\n                <Text color=\"#f6c179\">{Store.stakingInfo.SBPBalance/10**18} SBP </Text>\n              </Row>\n            </StakingInfo>\n            <Logo src={shiba} />\n          </FlexDiv>\n          <Input\n            style={{ marginTop: '1rem' }}\n            onChange={handleAmount}\n            value={stakingAmount}\n          />\n          <FlexDiv>\n            <StakeButton onClick={handleStake} disabled={disable}>\n              {stakeable(Store.stakingInfo.allowance, stakingAmount)\n                ? 'StakeSBP'\n                : 'ApproveSBP'}\n            </StakeButton>\n          </FlexDiv>\n        </StakingInfoWrapper>\n      </StakingWrapper>\n    );\n  });\n};\n\nexport default StakingBox;\n\nconst StakingWrapper = styled.div`\n  border-radius: 1rem;\n  border: solid 0.13rem #f6c179;\n  margin: 0 1rem 0 1rem;\n  background-color: #594139;\n`;\nconst SelectWrapper = styled.div`\n  background-color: #74564a;\n  border-radius: 0.85rem 0.85rem 0 0;\n  padding: 1rem;\n`;\nconst SelectBoxWrapper = styled.div`\n  padding: 0.5rem;\n  display: flex;\n  flex: 1 1 0;\n`;\nconst SelectBox = styled.button`\n  border-radius: 0.25rem;\n  border: ${props => (props.checked ? 'solid 2px #fff' : 'none')};\n  /* margin: 0.1rem 0.5rem 0.1rem 0.5rem; */\n  margin: auto 0.1rem auto 0.1rem;\n  color: ${props => (props.checked ? '#fff' : '#74564a')};\n  background-color: ${props => (props.checked ? '#66ac5b' : '#d5ccc8')};\n  &:hover {\n    background-color: #66ac5b;\n    color: '#74564a';\n  }\n  font-family: Teko;\n  font-size: 1.3rem;\n  transition: background-color 0.25s ease-out 100ms;\n`;\nconst StakingInfoWrapper = styled.div`\n  padding: 1rem;\n  border-radius: 0 0 0.85rem 0.85rem;\n  background-color: #594139;\n  /* display: flex; */\n`;\n\nconst StakingInfo = styled.div`\n  flex: auto;\n  min-width: 11rem;\n`;\nconst Logo = styled.img`\n  width: 8rem;\n  @media (max-width: 500px) {\n    width: 6rem;\n  }\n  @media (max-width: 360px) {\n    width: 4rem;\n  }\n  object-fit: contain;\n\n  margin: 0 0 0 1rem;\n`;\n\nconst FlexDiv = styled.div`\n  display: flex;\n`;\n\nconst StakeButton = styled.button`\n  width: 7rem;\n  height: 2rem;\n  border-radius: 1rem;\n  border: solid 2px #d5ccc8;\n  background-color: #66ac5b;\n  font-family: Teko;\n  font-size: 1.3rem;\n  font-weight: 500;\n  font-stretch: normal;\n  font-style: normal;\n  /* line-height: 1; */\n  letter-spacing: normal;\n  text-align: center;\n  color: #fff;\n  margin: 1rem auto 0 auto;\n  ${props => {\n    if (props.disabled) {\n      return 'border: solid 2px #757575; background-color: #74564a; color: #757575';\n    }\n  }}\n`;\n"]},"metadata":{},"sourceType":"module"}